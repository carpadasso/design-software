@startuml

autonumber
skinparam sequenceArrowThickness 2
skinparam participantPadding 10
skinparam boxPadding 10

actor "Cliente" as Cliente
participant "API Gateway" as Gateway
participant "ServiÃ§o de Pagamentos" as SvcPagamentos
participant "ServiÃ§o de Reservas" as SvcReservas
database "DB (Pagamentos)" as DBPagamentos
database "DB (Reservas)" as DBReservas

Cliente -> Gateway : POST /pagamentos/{id}/confirmar\n(status: "sinal pago" ou "quitado")
activate Gateway
Gateway -> SvcPagamentos : POST /pagamentos/{id}/confirmar
activate SvcPagamentos

SvcPagamentos -> DBPagamentos : Atualiza status para "PAGO" ou "QUITADO"
activate DBPagamentos
DBPagamentos --> SvcPagamentos : (Sucesso, retorna IdReserva associado)
deactivate DBPagamentos

SvcPagamentos -> SvcReservas : PATCH /reservas/{id_reserva}/status\n(body: "CONFIRMADA")
activate SvcReservas

SvcReservas -> DBReservas : Atualiza status da reserva para "CONFIRMADA"
activate DBReservas
DBReservas --> SvcReservas : (Sucesso)
deactivate DBReservas

SvcReservas --> SvcPagamentos : 200 OK
deactivate SvcReservas
SvcPagamentos --> Gateway : 200 OK (Pagamento confirmado)
deactivate SvcPagamentos
Gateway --> Cliente : 200 OK
deactivate Gateway

@enduml